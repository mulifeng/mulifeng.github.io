---
title: "Monty Hall problem"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(grid)
```

```{r}
data <- data.frame(x = c(rep(1:3, each = 4)), 
                         y = c(1, 3, 4.5, 5.5, 1, 2.5, 3.5, 5, 0.5, 1.5, 3, 5), 
                   width = c(rep(1, 12)),
                   heigh = c(2, 2, 1, 1, 2, 1, 1, 2, 1, 1, 2, 2),
                         label = c("C-B", "B-C", "A-C", "A-B", "C-A", "B-C",
                                   "B-A", "A-C", "C-B", "C-A", "B-A", "A-B"),
                   prob = c("1/3*1", "1/3*1", "1/3*1/2", "1/3*1/2",
                            "1/3*1", "1/3*1/2", "1/3*1/2", "1/3*1",
                            "1/3*1/2", "1/3*1/2", "1/3*1", "1/3*1"))
```



```{r}
ggplot(data, aes(x = x, y = y)) +
  geom_tile(aes(width = width, height = heigh, fill = label)) +
  geom_text(aes(label = paste(label, "\n", prob))) +
  #ylim(-4, 7) +
  annotate("text", x=1:3, y = 6.5, 
           label = c("æ±½è½¦åœ¨Aé—¨åŽ(1/3)", "æ±½è½¦åœ¨Bé—¨åŽ(1/3)", "æ±½è½¦åœ¨Cé—¨åŽ(1/3)")) +
  scale_fill_discrete(name = "", label = c("A-B é€‰Aå¼€B", "A-C é€‰Aå¼€C", "B-A é€‰Bå¼€A",
                         "B-C é€‰Bå¼€C", "C-A é€‰Cå¼€A", "C-B é€‰Cå¼€B")) +
  theme_bw() +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        axis.title = element_blank(),
        axis.text = element_blank())



```

```{r, echo=FALSE}
grid.text("P(A|A-B) = 1/6/(1/6+1/3) = 1/3\nP(B|A-B) = 0\nP(C|A-B) = 1/3/(1/6+1/3) = 2/3\nP(A|A-C) = 1/6/(1/6+1/3) = 1/3\nP(B|A-C) = 1/3/(1/6+1/3) = 2/3\nP(C|A-B) = 0\nP(A|B-A) = 0\nP(B|B-A) = 1/6/(1/6+1/3) = 1/3\nP(C|B-A) = 1/3/(1/6+1/3) = 2/3\nP(A|B-C) = 1/3/(1/6+1/3) = 2/3\nP(B|B-C) = 1/6/(1/6+1/3) = 1/3\nP(C|B-C) = 0\nP(A|C-A) = 0\nP(B|C-A) = 1/3/(1/6+1/3) = 2/3\nP(C|C-A) = 1/6/(1/6+1/3) = 1/3\nP(A|C-B) = 1/3/(1/6+1/3) = 2/3\nP(B|C-B) = 0\nP(C|C-B) = 1/6/(1/6+1/3) = 1/3\nåœ¨ä¸»æŒäººæ‰“å¼€å…¶ä¸­çš„ä¸€æ‰‡é—¨ä¹‹å‰ï¼Œé€‰ä¸­æ±½è½¦\nçš„æ¦‚çŽ‡ä¸º1/3ï¼Œé€‰Aå¼€BåŽæ±½è½¦åœ¨Aé—¨åŽçš„æ¦‚çŽ‡\nä»ä¸º1/3ï¼Œæ±½è½¦åœ¨Cé—¨åŽçš„æ¦‚çŽ‡å¢žåŠ è‡³2/3ï¼Œæ‰€ä»¥\nè‹¥æ›´æ¢æœ€åˆçš„é€‰æ‹©å¯ä»¥æé«˜é€‰ä¸­æ±½è½¦çš„æ¦‚çŽ?", x = 0, hjust = 0, gp = gpar(cex=2))
```

